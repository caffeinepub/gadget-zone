{
  "kind": "build_request",
  "title": "Add GA4 gtag.js snippet with measurement ID G-HBEHE5MY5Y",
  "priority": "normal",
  "requirements": [
    {
      "id": "REQ-1",
      "text": "Update the app to load and configure Google Analytics 4 via gtag.js using measurement ID \"G-HBEHE5MY5Y\" so that GA4 is enabled in production without requiring an environment variable placeholder.",
      "target": "frontend",
      "source": {
        "messageIds": [
          "msg-9"
        ],
        "quotes": [
          "<!-- Google tag (gtag.js) -->\n<script async src=\"https://www.googletagmanager.com/gtag/js?id=G-HBEHE5MY5Y\"></script>\n<script>\n  window.dataLayer = window.dataLayer || [];\n  function gtag(){dataLayer.push(arguments);}\n  gtag('js', new Date());\n\n  gtag('config', 'G-HBEHE5MY5Y');\n</script>"
        ]
      },
      "acceptanceCriteria": [
        "In the built app HTML head, the gtag.js script is loaded from https://www.googletagmanager.com/gtag/js?id=G-HBEHE5MY5Y.",
        "On initial page load, window.dataLayer is initialized and gtag('config','G-HBEHE5MY5Y') is called.",
        "Existing GA4 helper code (e.g., SPA page views and click tracking) continues to function by finding window.gtag defined at runtime.",
        "No user-facing text is changed as part of this tracking addition."
      ]
    },
    {
      "id": "REQ-2",
      "text": "Ensure the Google Analytics configuration in the codebase remains consistent after enabling gtag.js with measurement ID \"G-HBEHE5MY5Y\" (i.e., avoid contradictory or duplicate GA initialization paths between frontend/index.html and frontend/src/lib/* tracking modules).",
      "target": "frontend",
      "source": {
        "messageIds": [
          "msg-9"
        ],
        "quotes": [
          "Use English for any user-facing text in the build request."
        ]
      },
      "acceptanceCriteria": [
        "There is a single, deterministic GA4 initialization flow (no double-injection of GA scripts and no conflicting measurement IDs).",
        "The app does not throw runtime errors in console related to gtag/dataLayer initialization when loading the homepage and navigating within the SPA."
      ]
    }
  ],
  "constraints": [
    "Do not edit files under frontend/src/components/ui or any other immutablePaths listed in SYSTEM_CONTEXT.",
    "Keep the backend as-is; GA4 tracking must be implemented entirely in the frontend."
  ],
  "nonGoals": [
    "Adding third-party analytics providers other than Google Analytics (gtag.js).",
    "Adding cookie consent banners or consent mode configuration.",
    "Implementing server-side event forwarding or backend tracking."
  ],
  "imageRequirements": {
    "required": [],
    "edits": []
  }
}